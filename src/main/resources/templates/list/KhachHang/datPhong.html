<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DragonBall Hotel</title>
    <!-- Bootstrap CSS -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom CSS -->
    <link rel="stylesheet" th:href="@{/css/styleKH.css}"/>


</head>
<style>

    #loadPhongCustermoContainer {
        display: flex;
        flex-wrap: wrap; /* Cho phép các mục phòng xuống dòng */
        justify-content: space-between; /* Căn đều các mục */
    }

    /* Thêm phần tiêu đề cho Top 3 phòng nổi bật */
    .top-phong-title {
        text-align: center;
        font-size: 2.5em;
        font-weight: bold;
        color: #333;
        margin-bottom: 30px;
        padding-top: 20px;
        text-transform: uppercase;
    }

    /* Container Flexbox để các mục phòng hiển thị trên cùng một hàng */
    .phong-list {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between; /* Tạo khoảng cách đều giữa các mục phòng */
        gap: 20px; /* Khoảng cách giữa các mục phòng */
    }

    /* Style cho phần mục phòng */
    .phong-item {
        flex: 1 1 calc(33.333% - 20px); /* Mỗi phòng chiếm 1/3 chiều rộng với khoảng cách nhỏ giữa các mục */
        border: 1px solid #ddd;
        padding: 15px;
        margin-bottom: 20px;
        text-align: center;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        border-radius: 8px;
        transition: transform 0.2s;
        background-color: #fff; /* Màu nền trắng cho các mục phòng */
        overflow: hidden; /* Đảm bảo không bị tràn ra ngoài */
    }

    .phong-item:hover {
        transform: scale(1.05);
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2); /* Tăng độ đổ bóng khi hover */
    }

    .phong-image {
        width: 100%;
        max-width: 300px;
        height: auto;
        border-radius: 8px;
        margin-bottom: 15px;
    }

    .phong-ten {
        font-size: 1.5em;
        font-weight: bold;
        color: #333;
        margin-bottom: 10px;
    }

    .phong-gia {
        font-size: 1.8em;
        color: #e74c3c;
        font-weight: bold;
        margin-bottom: 15px;
    }

    .btn-dat-phong {
        padding: 10px 20px;
        font-size: 1em;
        color: #fff;
        background-color: #28a745; /* Màu xanh lá cây */
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s;
    }

    .btn-dat-phong:hover {
        background-color: #218838; /* Màu xanh lá cây đậm hơn khi hover */
    }

    /* Responsive: Chuyển thành 2 cột khi màn hình nhỏ hơn */
    @media (max-width: 992px) {
        .phong-item {
            flex: 1 1 calc(50% - 20px); /* Chuyển về dạng 2 cột khi màn hình nhỏ hơn */
        }
    }

    /* Responsive: Chuyển thành 1 cột trên thiết bị nhỏ hơn */
    @media (max-width: 768px) {
        .phong-item {
            flex: 1 1 100%; /* Chuyển về dạng 1 cột khi màn hình nhỏ */
        }
    }

    .card {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .card:hover {
        transform: scale(1.05);
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
    }
    .room-class-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        position: relative;
    }

    #room-class-list {
        display: none;
        background-color: black;
        border-radius: 5px;
        position: absolute;
        top: 100%;
        left: 50%;
        transform: translateX(-50%);
        z-index: 1000;
    }

    #room-class-list li {
        color: white;
        padding: 10px;
        cursor: pointer;
        text-align: center;
    }

    #room-class-list li:hover {
        background-color: #333;
    }
    .card {
        text-align: center;
        margin: 0 auto;
    }

    .card-body {
        display: flex; /* Sử dụng flexbox để căn giữa */
        flex-direction: column; /* Đặt chiều dọc */

        align-items: center; /* Căn giữa theo chiều ngang */
    }

    .card-title, .card-text {
        margin: 10px 0; /* Thêm khoảng cách giữa tiêu đề và giá */
    }
    .container {
        display: grid;
        grid-gap: 11px; /* Thêm khoảng cách 11px giữa các phần tử trong lưới */
    }
    .room-card {
        margin: 30px auto; /* Căn giữa và tạo khoảng trắng đều cho trên dưới */

    }
    body {
        font-family: Arial, sans-serif;
    }
    .guest-dropdown {
        position: relative;
    }
    .guest-dropdown-content {
        display: none;
        position: absolute;
        top: 100%;
        left: 0;
        background-color: #fff;
        box-shadow: 0px 8px 16px rgba(0, 0, 0, 0.2);
        padding: 10px;
        border-radius: 5px;
        z-index: 1;
        min-width: 200px;
    }
    .control {
        display: flex;
        align-items: center;
        gap: 5px;
    }
    .control button {
        background-color: #e0e0e0;
        border: none;
        border-radius: 50%;
        width: 30px;
        height: 30px;
        font-size: 18px;
        cursor: pointer;
    }
    .control span {
        font-size: 16px;
        min-width: 20px;
        text-align: center;
    }

    .features {
        display: flex; /* Sử dụng Flexbox để căn chỉnh các phần tử ngang hàng */
        justify-content: center; /* Căn giữa các phần tử theo chiều ngang */
        gap: 20px; /* Khoảng cách giữa các phần tử */
        text-align: center; /* Căn giữa nội dung trong mỗi <p> */
    }

    .features p {
        font-size: 1rem;
        color: #555;
        display: flex;
        align-items: center;
        gap: 8px; /* Khoảng cách giữa icon và văn bản */
    }

    .features i {
        font-size: 1.5rem; /* Kích thước biểu tượng */
        color: #4caf50; /* Màu xanh cho biểu tượng */
    }


    .eco-garden-description {
        margin-bottom: 2rem;
        padding: 20px;
        background-color: #f4fff0;  /* Nền màu nhạt */
        border-radius: 8px;
        text-align: left; /* Căn trái */
    }

    .eco-garden-description h2 {
        font-size: 1.8rem;
        font-weight: bold;
        margin-bottom: 1rem;
        text-align: center; /* Căn giữa tiêu đề */
    }

    .eco-garden-description .features p {
        font-size: 1rem;
        color: #555;
        display: flex;
        align-items: center;
        gap: 10px;
        margin: 5px 0;
    }

    .eco-garden-description .features i {
        font-size: 1.2rem;
        color: #4caf50; /* Màu xanh cho biểu tượng */
    }


    .border-container {
        border: 1px solid #ccc; /* Màu viền và độ dày */
        border-radius: 8px; /* Làm tròn các góc */
        padding: 15px; /* Khoảng cách giữa viền và nội dung */
        background-color: #f9f9f9; /* Màu nền */
    }
    .price-container {
        text-align: center; /* Căn giữa văn bản */
        margin-top: 10px; /* Tạo khoảng cách phía trên */
    }
    .room-title {
        font-size: 24px; /* Kích thước chữ lớn hơn */
        font-weight: bold; /* Chữ đậm */
        text-align: left; /* Căn trái văn bản */
        background: linear-gradient(to right, orange 50%, black 50%); /* Gạch đỏ nửa chữ từ bên trái */
        -webkit-background-clip: text; /* Clip nền cho chữ */
        color: transparent; /* Ẩn màu chữ để chỉ hiển thị nền */
        margin: 10px 0; /* Tạo khoảng cách trên và dưới */
        padding-bottom: 5px; /* Khoảng cách dưới chữ để không chèn vào gạch */
        display: inline-block; /* Để gạch chỉ dưới phần văn bản */
    }


    .room-title::after {
        content: ''; /* Tạo nội dung giả */
        display: block; /* Hiển thị như một khối */
        height: 2px; /* Độ dày của gạch */
        background-color: red; /* Màu gạch */
        position: absolute; /* Định vị tuyệt đối */
        bottom: 0; /* Gạch ở dưới cùng */
        left: 0; /* Bắt đầu từ bên trái */
        width: 50%; /* Chiều rộng của gạch là 50% */
    }

    .room-detail-container {
        display: flex;
        justify-content: center; /* Căn giữa toàn bộ nội dung */
        align-items: center; /* Căn giữa theo chiều dọc */
        padding: 20px; /* Khoảng cách bên trong */
    }

    .room-info {
        display: flex; /* Hiển thị theo hàng ngang */
        justify-content: center; /* Căn giữa theo chiều ngang */
        align-items: center; /* Căn giữa theo chiều dọc */
    }

    .image-container {
        flex: 1; /* Tự động chiếm không gian */
        margin-right: 10px; /* Khoảng cách giữa hình ảnh và form */
    }

    .booking-form {
        flex: 1; /* Tự động chiếm không gian */
        max-width: 400px; /* Chiều rộng tối đa của form */
        width: 100%; /* Đảm bảo form chiếm toàn bộ không gian */
    }

    .form-group {
        margin-bottom: 10px; /* Khoảng cách giữa các trường */
    }


    .container {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        max-width: 1200px;
        margin: auto;
        padding: 20px;
    }
    .room-info {
        display: flex;
        justify-content: center; /* Căn giữa các phần tử con theo chiều ngang */
        align-items: center; /* Căn giữa các phần tử con theo chiều dọc */
    }

    .booking-form {
        margin: 10px; /* Khoảng cách giữa các phần tử xung quanh */
        background-color: #f8f9fa; /* Màu nền cho form */
        border: 1px solid #ced4da; /* Viền cho form */
        border-radius: 5px; /* Bo góc */
        padding: 20px; /* Khoảng cách bên trong form */
        max-width: 400px; /* Chiều rộng tối đa của form */
        width: 100%; /* Chiều rộng 100% để chiếm toàn bộ không gian có sẵn */
    }


    .booking-form h4 {
        margin-bottom: 20px; /* Khoảng cách dưới tiêu đề */
        text-align: center; /* Căn giữa tiêu đề */
    }

    .form-group {
        margin-bottom: 15px; /* Khoảng cách giữa các trường trong form */
    }

    .form-control {
        height: 40px; /* Chiều cao cho các ô nhập liệu */
        border-radius: 5px; /* Bo góc cho các ô nhập liệu */
        border: 1px solid #ced4da; /* Viền nhẹ cho ô nhập liệu */
    }

    .form-control:focus {
        border-color: #80bdff; /* Màu viền khi ô được chọn */
        outline: none; /* Xóa viền mặc định */
        box-shadow: 0 0 5px rgba(0, 123, 255, 0.5); /* Đổ bóng cho ô nhập liệu */
    }

    .btn-warning {
        background-color: #ffc107; /* Màu nền cho nút */
        color: #fff; /* Màu chữ */
        border: none; /* Không có viền */
        border-radius: 5px; /* Bo góc cho nút */
        padding: 10px; /* Khoảng cách bên trong nút */
        cursor: pointer; /* Con trỏ khi hover */
        transition: background-color 0.3s; /* Hiệu ứng chuyển màu khi hover */
    }

    .btn-warning:hover {
        background-color: #e0a800; /* Màu nền khi hover */
    }



    .image-container {
        max-width: 100%;
        height: auto;
    }


    /* Style cho form đặt phòng */
    .booking-form {
        border: 1px solid #ddd;
        padding: 20px;
        border-radius: 8px;
        background-color: #f9f9f9;
    }

    /* Định dạng cho footer */
    footer {
        background-color: #343a40;
        color: white;
        padding: 20px 0;
        text-align: center;
    }

    /* Bố cục cho carousel */
    #carouselExample {
        height: 100vh;
    }

    .overlay {
        background: rgba(0, 0, 0, 0.5);
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
    }

    .reviews-section {
        margin-top: 20px;
        border-top: 1px solid #ddd;
        padding-top: 10px;
    }
    .review-item {
        margin-bottom: 15px;
        padding: 10px;
        background: #f9f9f9;
        border-radius: 5px;
        border: 1px solid #ddd;
    }
    .star {
        color: #f5c518;
        font-size: 18px;
    }
    .add-review-section {
        margin-top: 20px;
    }
    .add-review-section h3 {
        margin-bottom: 15px;
    }

    .reviews-section {
        display: flex;
        flex-wrap: wrap; /* Cho phép đánh giá xuống dòng nếu không đủ chỗ */
        gap: 20px; /* Khoảng cách giữa các đánh giá */
    }

    .review-item {
        flex: 1 1 calc(33.33% - 20px); /* Mỗi đánh giá chiếm 1/3 chiều rộng của container */
        box-sizing: border-box;
        border: 1px solid #ddd;
        padding: 10px;
        background-color: #f9f9f9;
    }

    .review-header {
        font-weight: bold;
    }

    .star {
        color: gold;
    }

</style>
<body>
<div class="container-fluid p-0 position-relative">
    <!-- Background Image -->
    <!-- Carousel -->
    <div id="carouselExample" class="carousel slide" data-ride="carousel" data-interval="2000">
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img th:src="@{/img/296817374_1015897554.jpg}" class="d-block w-100" alt="Slide 1" style="height: 100vh; object-fit: cover;">
            </div>
            <div class="carousel-item">
                <img th:src="@{/img/phong-khach-san-dep-de-chup-anh-o-ha-noi-3.jpg}" class="d-block w-100" alt="Slide 2" style="height: 100vh; object-fit: cover;">
            </div>
            <div class="carousel-item">
                <img th:src="@{/img/anhPhongKS1.jpg}" class="d-block w-100" alt="Slide 3" style="height: 100vh; object-fit: cover;">
            </div>
        </div>
    </div>

    <img th:src="@{/img/logo-Photoroom.png}" class="logo position-absolute" alt="Logo">
    <!-- Overlay content -->
    <div class="overlay position-absolute top-0 start-0 w-100 h-100 d-flex flex-column justify-content-center align-items-center text-center" style="background: rgba(0, 0, 0, 0.5);">

        <!-- Title -->
        <h1 class="text-white mb-3 text-center">Chào Mừng Đến Với DragonBall HOTEL</h1>

        <!-- Subtitle -->
        <p class="text-white mb-4 text-center">Tìm kiếm để so sánh giá cả và khám phá ưu đãi tuyệt vời</p>

        <!-- Search Bar -->
        <form action="/search1" method="GET" class="search-bar p-4 bg-white rounded shadow-sm d-flex align-items-center justify-content-between">
            <!-- Check-in & Check-out Section -->
            <div class="check-in-out d-flex align-items-center">
                <!-- Check-in -->
                <div class="input-group me-2">
                    <input type="datetime-local" id="ngayNhan" name="ngayNhan" class="form-control border-0" placeholder="Nhận phòng" required>
                </div>

                <!-- Check-out -->
                <div class="input-group me-2">
                    <input type="datetime-local" id="ngayTra" name="ngayTra" class="form-control border-0" placeholder="Trả phòng" required>
                </div>
            </div>

            <!-- Room and Guest Section -->
            <div class="guest-dropdown">
                <div class="guest-container" onclick="toggleDropdown()">
                    <span id="guest-display">1 người lớn</span> - <span id="room-display">1 phòng</span>
                </div>

                <div class="guest-dropdown-content" id="dropdown-content">
                    <div class="control">
                        <label>Phòng</label>
                        <button type="button" onclick="changeRoom(-1)">-</button>
                        <span id="room-count1">1</span>
                        <button type="button" onclick="changeRoom(1)">+</button>
                    </div>
                    <div class="control">
                        <label>Người</label>
                        <button type="button" onclick="changeGuest(-1)">-</button>
                        <span id="guest-count">1</span>
                        <button type="button" onclick="changeGuest(1)">+</button>
                    </div>
                </div>
            </div>

            <!-- Ẩn các input để truyền số phòng và số người -->
            <input type="hidden" id="soPhong" name="soPhong" value="1">
            <input type="hidden" id="soNguoi" name="soNguoi" value="1">
            <!-- Search Button -->
            <button class="btn btn-primary px-4" type="submit">Tìm</button>
        </form>


        <!-- Login Button -->
        <div class="login-button-container position-absolute top-0 end-0 m-3">
            <!--             Kiểm tra nếu session không có user (chưa đăng nhập) -->
            <th:block th:if="${hoVaTen == null}">
                <a href="/login" class="btn btn-outline-light btnLogin">Đăng nhập</a>
            </th:block>
            <!--             Kiểm tra nếu session có user (đã đăng nhập) -->
            <th:block th:if="${hoVaTen != null}">
                <div class="dropdown">
                    <!-- Hiển thị tên người dùng và icon -->
                    <button class="btn btn-secondary dropdown-toggle d-flex align-items-center gap-2"
                            type="button" data-toggle="dropdown" aria-expanded="false">
                        <span th:text="${hoVaTen}"></span>
                        <i class="fas fa-user-circle"></i> <!-- Biểu tượng người dùng -->
                    </button>
                    <div class="dropdown-menu shadow-sm">
                        <a class="dropdown-item d-flex align-items-center gap-2" href="/khach-hang/trang-ca-nhan">
                            <i class="fas fa-user"></i> Trang cá nhân
                        </a>
                        <a class="dropdown-item d-flex align-items-center gap-2" href="/khach-hang/logout">
                            <i class="fas fa-sign-out-alt"></i> Đăng xuất
                        </a>
                    </div>
                </div>
            </th:block>
        </div>

        <div class="Home-button-container d-flex align-items-center position-absolute top-0 end-0 m-3">
            <!-- Trang Chủ -->
            <a href="/khach-hang" class="text-link mb-2 p-2">Trang Chủ</a>
            <!-- Giới Thiệu -->
            <a href="/about" class="text-link mb-2 p-2">Giới Thiệu</a>
            <!-- Hạng Phòng -->
            <div class="room-class-container">
                <div id="room-classes-button" class="text-link mb-2 p-2" style="cursor: pointer;">Hạng Phòng</div>
                <ul id="room-class-list" class="dropdown-menu" style="list-style: none; padding: 0; margin: 0;">
                    <li data-loai-phong-id="1">Standard</li>
                    <li data-loai-phong-id="2">Superior</li>
                    <li data-loai-phong-id="3">Family suite</li>
                    <li data-loai-phong-id="4">Deluxe</li>
                </ul>
            </div>



        </div>
    </div>

    <!-- Các nút chọn ngôn ngữ -->
    <div class="language-buttons d-flex top-0 end-0">
        <div id="vi-btn" class="language-option p-2" style="display: flex; align-items: center; cursor: pointer;" >
            <img src="https://upload.wikimedia.org/wikipedia/commons/2/21/Flag_of_Vietnam.svg" alt="Cờ Việt Nam" style="width: 20px; height: 15px; margin-right: 5px;">
            Tiếng Việt
        </div>
        <div id="en-btn" class="language-option p-2" style="display: flex; align-items: center; cursor: pointer;">
            <img src="https://upload.wikimedia.org/wikipedia/en/a/ae/Flag_of_the_United_Kingdom.svg" alt="Cờ Anh" style="width: 20px; height: 15px; margin-right: 5px;">
            English
        </div>
    </div>
</div>

<div id="customerInfoForm" th:if="${not #authorization.expression('hasRole(''CUSTOMER'')')}" class=" shadow" style=" max-width: 1000px ; flex: 1">
    <div class="card shadow-sm border-0 text-start">
        <div class="card-body">
            <h4 class="mb-3 text-center">Thông Tin Khách Hàng</h4>
            <form id="customerForm">

                <input type="hidden"  id="maKhachHang" name="maKhachHang">
                <div class="mb-3">
                    <label for="hoVaTen" class="form-label">Họ và Tên:</label>
                    <input type="text" class="form-control form-control-sm" id="hoVaTen" name="hoVaTen" placeholder="Họ và tên" required>
                </div>
                <div class="mb-3">
                    <label for="email" class="form-label">Email:</label>
                    <input type="email" class="form-control form-control-sm" id="email" name="email" placeholder="Email" required>
                </div>
                <div class="mb-3">
                    <label for="soDienThoai" class="form-label">Số Điện Thoại:</label>
                    <input type="text" class="form-control form-control-sm" id="soDienThoai" name="soDienThoai" placeholder="Số điện thoại" required>
                </div>

                <button type="button" id="confirmCustomerBtn" class="btn btn-dark w-100">Xác Nhận Thông Tin</button>
            </form>
        </div>
    </div>
</div>

<div class="room-detail-container d-flex justify-content-center">
    <div class="room-details">
        <div class="room-info d-flex justify-content-center align-items-center">
            <div class="image-container flex-fill me-3 border-container">
                <p class="room-title">
                    <b th:text="${phong.tenPhong}"></b>
                </p>
                <p>
                    <span>Phòng:</span>
                    <span th:text="${phong.tenPhong}"></span>
                    <span th:text="${phong.moTa}"></span>
                </p>
                <img src="/img/anhPhongKS1.jpg" alt="" style="max-width: 100%; height: auto;">
                <div class="price-container text-center">
                    <p>
                        <span>Chỉ với</span>
                        <span th:text="${#numbers.formatCurrency(phong.giaLoaiPhong)} + ' VNĐ'"></span>
                        <span> cho 1 đêm</span>
                    </p>
                    <input type="hidden" id="pricePerNight" th:value="${phong.giaLoaiPhong}" /> <!-- Sửa lại th:value -->
                    <p>
                        <span>Sức chứa tối đa gồm:</span>
                        <span th:text="${phong.getSoNguoiToiDa()}"></span>
                        <span>người</span>
                    </p>
                </div>

                <div>

                </div>
                <div class="reviews-section" id="reviewForm">

                </div>





            </div>
        </div>
    </div>


    <div class="booking-form flex-fill">
        <h4>ĐẶT PHÒNG</h4>
        <form id="idDatPhong">
            <div class="form-group">
                <label for="checkin">Ngày đến</label>
                <input type="datetime-local" class="form-control" id="checkinDate" name="ngayNhan" required>
            </div>
            <div class="form-group">
                <label for="checkout">Ngày đi</label>
                <input type="datetime-local" class="form-control" id="checkoutDate" name="ngayTra" required>
            </div>
            <div class="form-group">
                <label for="cccd">Căn cước công dân</label>
                <input type="text" class="form-control" id="cccd" name="cccd" required pattern="\d{9}|\d{12}" title="Vui lòng nhập CCCD đúng định dạng (9 hoặc 12 chữ số)">
            </div>
            <div class="form-group">
                <label for="deposit">Số tiền cọc (80%):</label>
                <input type="text" class="form-control" id="deposit" readonly>
                <input type="hidden" id="rawDeposit" name="gia">
            </div>
            <!--            <div class="form-group">-->
            <!--                <label for="amount">Số tiền đặt cọc:</label>-->
            <!--                <input type="hidden" class="form-control" id="amount" name="amount" readonly/>-->
            <!--            </div>-->

            <div class="form-group">
                <label for="pay">Phương thức thanh toán</label> <br>
                <input type="radio" id="pay" name="bankCode" value="VNBANK" checked>
                <label for="pay" class="text-danger-dark">VnPay</label>
            </div>

            <div class="form-group">
                <h5>Chọn ngôn ngữ giao diện thanh toán:</h5>
                <input type="radio" checked id="language-vn" name="language" value="vn">
                <label for="language-vn">Tiếng việt</label><br>
                <input type="radio" id="language-en" name="language" value="en">
                <label for="language-en">Tiếng anh</label><br>
            </div>

            <!-- Trường ẩn để gửi idPhong và idLoaiPhong -->
            <input type="hidden" id="idPhong" name="idPhong" th:value="${phong.idPhong}" />
            <input type="hidden" id="idLoaiPhong" name="idLoaiPhong" th:value="${phong.idLoaiPhong}" />

            <!-- Hiển thị idKhachHang nếu có -->
            <input type="hidden" id="idKhachHang" name="idKhachHang" th:value="${idKhachHang}"  />

            <button type="submit" class="btn btn-warning btn-block">ĐẶT TRƯỚC</button>
        </form>

    </div>


</div>



<footer class="bg-dark text-white py-4 mt-2">
    <div class="container">
        <div class="row">
            <!-- Google Maps Embed (Left) -->
            <div class="col-md-6">
                <h5 class="text-white">Vị trí của chúng tôi</h5>
                <div class="map-container">
                    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d4337.097401206077!2d105.74389980195575!3d21.045412325554775!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x313455b3f6710da1%3A0x240105831b77a1a2!2zVHLGsOG7nW5nIENhbyDEkeG6s25nIEZQVCBQb2x5dGVjaG5pYw!5e0!3m2!1sen!2s!4v1728742407402!5m2!1sen!2s" width="100%" height="300" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                </div>

            </div>

            <!-- Contact Info (Right) -->
            <div class="col-md-6">
                <h5 class="text-white" id="footerContact">Thông tin liên hệ</h5>
                <p class="mb-0" id="footerAddress">Địa chỉ: P. Kiều Mai, Phúc Diễn, Từ Liêm, Hà Nội</p>
                <p id="footerEmail">Email: contact@dragonballhotel.com</p>
                <p id="footerPhone">Phone: +84 397156204</p>
                <ul class="list-inline">
                    <li class="list-inline-item"><a href="#" class="text-white">Facebook</a></li>
                    <li class="list-inline-item"><a href="#" class="text-white">Instagram</a></li>
                    <li class="list-inline-item"><a href="#" class="text-white">Twitter</a></li>
                </ul>
            </div>

        </div>
        <!-- Divider -->
        <div class="divider"></div>
        <!-- Copyright Section -->
        <div class="text-center mt-4">
            <p class="copyright mb-0">&copy; 2024 DragonBall Hotel. All Rights Reserved.</p>
        </div>
    </div>
</footer>
<!-- Thêm SweetAlert từ CDN -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-7Ma6PSjbFvGJfcQ/E0i1XAfE5jHn1cdCpK2WhCbcMyJgpj5tI4TD/ThUydFm2pwf" crossorigin="anonymous"></script>
<script>


    // đặt phòng
    document.getElementById("idDatPhong").addEventListener("submit", function (event) {
        event.preventDefault(); // Ngăn chặn gửi form mặc định

        const formEle = document.getElementById("idDatPhong");
        const form = new FormData(formEle);
        const formString = new URLSearchParams(form).toString();

        const idLoaiPhong = document.getElementById("idLoaiPhong").value;
        const idPhong = document.getElementById("idPhong").value;
        const bankCode = document.querySelector('input[name="bankCode"]:checked')
            ? document.querySelector('input[name="bankCode"]:checked').value
            : "";
        const languageElement = document.querySelector('select[name="language"]');
        const language = languageElement ? languageElement.value : "";

        const ngayNhan = document.getElementById("checkinDate").value;
        const ngayTra = document.getElementById("checkoutDate").value;
        const cccd = document.getElementById("cccd").value;
        const idKhachHang = document.querySelector('input[name="idKhachHang"]').value;

        // Kiểm tra dữ liệu quan trọng
        if (!idPhong || !ngayNhan || !ngayTra || !cccd) {
            alert("Các trường ID phòng, ngày nhận, ngày trả, CCCD không được để trống!");
            return;
        }

        if (!idKhachHang) {
            Swal.fire({
                title: "Vui lòng đăng nhập để đặt phòng!",
                icon: "error",
                showCancelButton: true,
                confirmButtonText: "Đăng nhập",
                cancelButtonText: "Đóng",
            }).then((swalResult) => {
                if (swalResult.isConfirmed) {
                    // Chuyển hướng sang trang login
                    window.location.href = "/login"; // Thay "/login" bằng URL trang đăng nhập của bạn
                }
            });
            return;
        }


        Swal.fire({
            title: "Bạn chắc chắn muốn đặt phòng chứ?",
            icon: "question",
            showCancelButton: true,
            confirmButtonText: "Có",
            cancelButtonText: "Không",
        }).then((swalResult) => {
            if (swalResult.isConfirmed) {
                fetch("/dat-phong", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/x-www-form-urlencoded",
                    },
                    body: formString,
                })
                    .then((response) => {
                        if (!response.ok) {
                            return response.json().then((errData) => {
                                throw new Error("Network response was not ok: " + errData.message);
                            });
                        }
                        return response.json();
                    })
                    .then((data) => {
                        if (data.code === "00") {
                            console.log("Đặt phòng thành công");
                            window.location.href = data.data; // Chuyển hướng
                        } else {
                            alert("Lỗi: " + data.error);
                        }
                    })
                    .catch((error) => {
                        alert("Có lỗi xảy ra: " + error.message);
                        console.error("Error:", error);
                    });
            }
        });
    });

    document.addEventListener("DOMContentLoaded", function () {
        const pricePerNight = parseFloat(document.getElementById("pricePerNight").value);

        document.getElementById("checkinDate").addEventListener("change", calculateDeposit);
        document.getElementById("checkoutDate").addEventListener("change", calculateDeposit);

        function calculateDeposit() {
            const checkin = document.getElementById("checkinDate").value;
            const checkout = document.getElementById("checkoutDate").value;

            if (checkin && checkout) {
                const checkinDate = new Date(checkin);
                const checkoutDate = new Date(checkout);

                if (checkinDate >= checkoutDate) {
                    alert("Ngày nhận phải trước ngày trả!");
                    document.getElementById("deposit").value = "";
                    return;
                }

                const diffTime = Math.abs(checkoutDate - checkinDate);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

                if (diffDays > 0) {
                    const totalCost = diffDays * pricePerNight;
                    const depositAmount = totalCost * 0.8;
                    // Gán giá trị hiển thị định dạng (VNĐ) vào input readonly (để người dùng xem)
                    document.getElementById('deposit').value = depositAmount.toLocaleString('vi-VN') + ' VNĐ';

// Thêm giá trị thô vào input ẩn để gửi về server
                    document.getElementById('rawDeposit').value = depositAmount;
                } else {
                    document.getElementById("deposit").value = "";
                }
            } else {
                document.getElementById("deposit").value = "";
            }
        }
    });

    document.getElementById("reviewForm").addEventListener("submit", async (e) => {
        e.preventDefault();

        const idPhong = document.getElementById("idPhong").value;
        const tenKhachHang = document.getElementById("tenKhachHang").value;
        const soSao = document.getElementById("soSao").value;
        const noiDung = document.getElementById("noiDung").value;

        const reviewData = { idPhong, tenKhachHang, soSao, noiDung };

        const response = await fetch('/api/danhgia', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(reviewData),
        });

        if (response.ok) {
            alert('Đánh giá của bạn đã được gửi!');
            location.reload();
        } else {
            alert('Có lỗi xảy ra, vui lòng thử lại!');
        }
    });


    // Gọi API để lấy danh sách đánh giá của phòng
    function fetchDanhGia(idPhong) {
        fetch(`/api/danhgia/${idPhong}`)
            .then(response => response.json())
            .then(data => {
                const reviewsContainer = document.querySelector('.reviews-section');
                reviewsContainer.innerHTML = ''; // Xóa nội dung cũ trước khi hiển thị mới

                    data.forEach(danhgia => {
                        const reviewItem = `
                     <div class="review-item">
                <div class="review-header">

                    <strong>${danhgia.tenKhachHang}</strong>
                    ${renderStars(danhgia.soSao)}
                </div>
                <p>${danhgia.noiDung}</p>
                <small>${danhgia.ngayDanhGia}</small>
                     </div>
    `;
                    reviewsContainer.innerHTML += reviewItem;
                });
            })
            .catch(error => console.error('Error fetching reviews:', error));
    }

    // Hàm tạo các sao đánh giá
    function renderStars(soSao) {
        let stars = '';
        for (let i = 0; i < soSao; i++) {
            stars += '<span class="star">&#9733;</span>'; // Sao đầy
        }
        for (let i = soSao; i < 5; i++) {
            stars += '<span class="star">&#9734;</span>'; // Sao trống
        }
        return stars;
    }

    // Gọi API khi trang được tải, sử dụng idPhong từ URL hoặc dữ liệu của bạn
    window.onload = function() {
        const idPhong = [[${phong.idPhong}]]; // Lấy idPhong từ URL hoặc từ thuộc tính khác
        fetchDanhGia(idPhong);
    };




    // Hàm thay đổi số phòng
    function changeRoom(change) {
        var roomCount = parseInt(document.getElementById('room-count1').innerText);
        roomCount += change;

        if (roomCount < 1) roomCount = 1;  // Đảm bảo số phòng không nhỏ hơn 1

        // Cập nhật giao diện
        document.getElementById('room-count1').innerText = roomCount;
        document.getElementById('room-display').innerText = roomCount + " phòng";

        // Cập nhật giá trị input ẩn
        document.getElementById('soPhong').value = roomCount;
    }

    // Hàm thay đổi số người
    function changeGuest(change) {
        var guestCount = parseInt(document.getElementById('guest-count').innerText);
        guestCount += change;

        if (guestCount < 1) guestCount = 1;  // Đảm bảo số người không nhỏ hơn 1

        // Cập nhật giao diện
        document.getElementById('guest-count').innerText = guestCount;
        document.getElementById('guest-display').innerText = guestCount + " người lớn";

        // Cập nhật giá trị input ẩn
        document.getElementById('soNguoi').value = guestCount;
    }

    // Hàm mở/đóng dropdown (tùy chọn)
    function toggleDropdown() {
        var dropdownContent = document.getElementById('dropdown-content');
        dropdownContent.style.display = dropdownContent.style.display === 'block' ? 'none' : 'block';
    }

    function setKhachHangId(id) {
        const idKhachHangInput = document.getElementById('idKhachHang');
        if (id && !isNaN(id)) {
            idKhachHangInput.value = id;
            console.log('ID khách hàng đã được thiết lập:', id); // Kiểm tra giá trị ID
        }
    }

    document.getElementById('confirmCustomerBtn').addEventListener('click', function () {
        const hoVaTen = document.getElementById('hoVaTen').value.trim();
        const email = document.getElementById('email').value.trim();
        const soDienThoai = document.getElementById('soDienThoai').value.trim();

        // Biểu thức chính quy cho tên hợp lệ
        const nameRegex = /^[a-zA-ZÀ-Ỵà-ỳ\s]+$/;
        // Kiểm tra tính hợp lệ của họ và tên
        if (!nameRegex.test(hoVaTen) || hoVaTen.length < 2 || hoVaTen.length > 50) {
            Swal.fire({
                icon: 'error',
                title: 'Tên không hợp lệ',
                text: 'Tên phải chứa các ký tự tiếng Việt hợp lệ, có ít nhất 2 ký tự và không quá 50 ký tự.',
                confirmButtonText: 'OK',
                timer: 3000,
                timerProgressBar: true
            });
            return; // Ngừng xử lý nếu tên không hợp lệ
        }

        // Kiểm tra các trường bắt buộc có bị để trống không
        if (!hoVaTen || !email || !soDienThoai) {
            Swal.fire({
                icon: 'error',
                title: 'Thiếu thông tin',
                text: 'Vui lòng điền đầy đủ thông tin vào các trường bắt buộc.',
                confirmButtonText: 'OK',
                timer: 3000,
                timerProgressBar: true
            });
            return; // Ngừng xử lý nếu có trường bị để trống
        }

        // Biểu thức chính quy để kiểm tra định dạng email
        const emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
        // Biểu thức chính quy để kiểm tra định dạng số điện thoại
        const phonePattern = /^(0[3|5|7|8|9])+([0-9]{8})$/;

        // Kiểm tra tính hợp lệ của email
        if (!emailPattern.test(email)) {
            Swal.fire({
                icon: 'error',
                title: 'Lỗi định dạng',
                text: 'Email không đúng định dạng. Vui lòng nhập lại.',
                confirmButtonText: 'OK'
            });
            return;
        }

        // Kiểm tra tính hợp lệ của số điện thoại
        if (!phonePattern.test(soDienThoai)) {
            Swal.fire({
                icon: 'error',
                title: 'Lỗi định dạng',
                text: 'Số điện thoại không đúng định dạng. Vui lòng nhập lại.',
                confirmButtonText: 'OK'
            });
            return;
        }

        // Gọi API kiểm tra email và số điện thoại
        fetch(`/khach-hang/check?email=${encodeURIComponent(email)}&soDienThoai=${encodeURIComponent(soDienThoai)}`)
            .then(response => response.json())
            .then(data => {
                if (data.emailExists || data.phoneExists) {
                    // Hiển thị thông báo nếu email hoặc số điện thoại đã tồn tại
                    Swal.fire({
                        icon: 'info',
                        title: 'Thông tin khách hàng đã tồn tại',
                        text: `Là Bạn Khách Hàng ${data.khachHang.hoVaTen},với Số điện thoại: ${data.khachHang.soDienThoai} phải không ạ`,
                        showCancelButton: true,
                        confirmButtonText: 'Đúng',
                        cancelButtonText: 'Không Phải'
                    }).then((result) => {
                        if (result.isConfirmed) {
                            // Nếu người dùng nhấn OK, lưu ID khách hàng vào form đặt phòng
                            setKhachHangId(data.khachHang.id); // Gọi hàm để thiết lập ID khách hàng
                            document.getElementById('idKhachHang').value = data.khachHang.id; // Đặt giá trị ID khách hàng vào form


                        }
                    });
                } else {
                    // Nếu không có trùng lặp, tiếp tục gửi thông tin khách hàng để lưu
                    const customerData = new FormData(document.getElementById('customerForm'));

                    fetch('/datphongs/xacnhan', {
                        method: 'POST',
                        body: customerData
                    })
                        .then(response => response.json())

                        .then(result => {
                            console.log('Server response:', result); // Kiểm tra phản hồi từ server

                            if (result.success) {
                                const khachHangId = result.khachHang.id; // Lấy ID khách hàng từ phản hồi
                                if (khachHangId) {
                                    setKhachHangId(khachHangId); // Gọi hàm để thiết lập ID khách hàng
                                } else {
                                    console.error('Không có ID khách hàng trong phản hồi.');
                                }

                                Swal.fire({
                                    icon: 'success',
                                    title: 'Thông Tin Khách Hàng Được Lưu!',
                                    text: 'Thông tin khách hàng đã được lưu thành công.',
                                    showConfirmButton: true
                                }).then(() => {
                                    document.getElementById('customerInfoForm').style.display = 'none'; // Ẩn form thông tin khách hàng
                                });
                            } else {
                                Swal.fire({
                                    icon: 'error',
                                    title: 'Lỗi!',
                                    text: 'Đã xảy ra lỗi khi lưu thông tin khách hàng. Vui lòng thử lại sau.',
                                    showConfirmButton: true
                                });
                            }
                        })
                        .catch(error => {
                            console.error('Lỗi khi gửi thông tin khách hàng:', error);
                            Swal.fire({
                                icon: 'error',
                                title: 'Lỗi!',
                                text: 'Đã xảy ra lỗi khi gửi thông tin khách hàng. Vui lòng thử lại sau.',
                                showConfirmButton: true
                            });
                        });
                }
            })
            .catch(error => {
                console.error('Lỗi khi kiểm tra thông tin khách hàng:', error);
                Swal.fire({
                    icon: 'error',
                    title: 'Lỗi hệ thống',
                    text: 'Đã có lỗi xảy ra. Vui lòng thử lại sau.',
                    confirmButtonText: 'OK'
                });
            });
    });

</script>
</body>
</html>